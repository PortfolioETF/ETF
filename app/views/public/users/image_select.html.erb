<h1>画像登録</h1>
<%= form_with model: @user do |f| %>
<%= image_tag '/assets/no_image.jpg', id: :img_prev %>
<%= f.file_field :image_id, id: :user_img, input_html: {accept: @user.set_extension} %>
<p><%= f.check_box :remove_img %>画像を削除する</p>

<div id="user_info">
  <div class="user_name">
    <%= @user.name %>
  </div>
  <div id="user_email">
    <%= @user.email %>
  </div>
  <div class="user_confirm_message">
    <p>こちらの内容で登録します</p>
  </div>
  <%= f.submit '登録' %>
  <% end %>
</div>
<%= link_to '画像を登録せずに進む', user_path(@user) %>


<script>
$(function() {
 function readURL(input) {
   if (input.files && input.files[0]) {
     var reader = new FileReader();
     reader.onload = function (e) {
       $('#img_prev').attr('src', e.target.result);
     }
     reader.readAsDataURL(input.files[0]);
   }
 }
 $("#user_img").change(function(){
   readURL(this);
   $('#user_info').toggle(true);
 });
});
</script>
